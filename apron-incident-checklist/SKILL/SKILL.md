---
name: apron-incident-checklist
description: "机坪特情处置检查单生成工具。用于生成机坪航空器漏油、油污、渗漏等特情事件的标准化处置检查单(.docx/.md格式)。当用户需要：(1) 创建新的特情处置记录，(2) 基于事件信息生成标准检查单，(3) 填写或更新机坪事件处置报告，(4) 生成符合民航安全审计要求的事件文档时触发此技能。"
---

# 机坪特情处置检查单生成

## 概述

本技能用于生成符合民航机坪运行规范的特情处置检查单。检查单涵盖事件识别、风险控制、协同处置、清污作业、恢复运行等完整流程，确保处置过程规范、可追溯、符合安全审计要求。

## 工作流程

### 信息收集 → 检查单生成 → 文档输出

1. **收集事件信息**：从用户获取事件基本信息
2. **选择模板类型**：根据事件类型匹配对应模板
3. **生成检查单**：填充数据并生成标准格式文档
4. **输出文件**：生成 .docx 或 .md 格式文件

## 事件类型判断

根据用户描述判断特情类型：

| 触发关键词 | 事件类型 | 模板 |
|-----------|---------|------|
| 漏油、滴油、油污、燃油泄漏 | 航空器漏油事件 | 漏油处置检查单 |
| 液压油、发动机油、滑油 | 油液泄漏事件 | 漏油处置检查单 |
| APU漏油、发动机渗漏 | 动力系统泄漏 | 漏油处置检查单 |

## 必需信息清单

生成检查单前，确认已收集以下信息（缺失项可留空由用户后续填写）：

### 核心信息（必须确认）
- 航班号/航空器注册号
- 事件发生时间
- 发现位置（机坪/滑行道/停机位/跑道入口）
- 上报方式（管制/巡查/传感器）

### 技术信息（尽量获取）
- 油液类型（燃油/液压油/发动机油/不明）
- 是否持续滴漏
- 泄漏面积评估
- 漏油形态（滴漏/流淌/喷溅）
- 发动机/APU状态

### 协同处置信息（可后续补充）
- 已通知单位列表
- 清污处置情况
- 运行影响评估

## 生成规则

### 文档格式要求

**DOCX格式**（推荐用于正式存档）：
- 使用docx-js生成
- 标题：宋体，加粗，居中
- 正文：宋体，12pt
- 表格：边框清晰，表头加粗灰底
- 复选框使用 ☐ 和 ☑ 符号

**Markdown格式**（用于快速查看或集成）：
- 使用标准Markdown表格语法
- 复选框使用 `☐ 是 ☐ 否` 格式

### 事件编号规则

自动生成格式：`TQCZ-YYYYMMDD-NNN`
- TQCZ：特情处置缩写
- YYYYMMDD：事件日期
- NNN：当日序号（001起）

示例：`TQCZ-20250130-001`

## 检查单结构模板

完整检查单包含以下章节，参见 [references/checklist-template.md](references/checklist-template.md)：

1. 事件基本信息
2. 特情初始确认（漏油基本情况）
3. 初期风险控制措施
4. 协同单位通知记录
5. 区域隔离与现场检查
6. 清污处置执行情况
7. 处置结果确认
8. 区域恢复与运行返还
9. 运行影响评估
10. 事件总结与改进建议
11. 签字与存档

## 输出示例

### 用户请求示例

**示例1 - 完整信息**：
> "帮我生成一份漏油检查单，CA1234航班，今天上午9:15在102停机位发现燃油滴漏，面积约2平方米，已通知机务和消防"

**示例2 - 部分信息**：
> "生成一个机坪特情处置检查单，航班号MU5678，发动机漏油"

### 生成响应

对于示例1，直接生成填充数据的检查单。
对于示例2，先询问缺失的关键信息（时间、位置、面积），或生成待填写模板。

## 代码实现指南

### 使用docx-js生成DOCX

生成DOCX文件时，先阅读docx skill的 [`docx-js.md`](/mnt/skills/public/docx/docx-js.md) 获取详细语法。

关键组件：
```javascript
import { Document, Paragraph, Table, TableRow, TableCell, TextRun, AlignmentType, BorderStyle } from "docx";

// 创建带边框的表格
const table = new Table({
  rows: [
    new TableRow({
      children: [
        new TableCell({ children: [new Paragraph("项目")] }),
        new TableCell({ children: [new Paragraph("记录")] }),
      ],
    }),
  ],
});
```

### 关键样式设置

```javascript
// 标题样式
new Paragraph({
  children: [new TextRun({ text: "机坪特情处置检查单", bold: true, size: 32 })],
  alignment: AlignmentType.CENTER,
});

// 复选框
new TextRun({ text: "☐ 是  ☐ 否" });
new TextRun({ text: "☑ 是  ☐ 否" }); // 已勾选
```

## 依赖

- **docx**: 生成.docx文件 (`npm install docx`)
- **fs**: 文件系统操作

## 注意事项

1. **时间格式**：统一使用 `YYYY-MM-DD HH:MM` 格式
2. **空值处理**：未知信息用横线 `——` 或留空供后续填写
3. **审计合规**：生成的检查单需包含完整的签字存档区域
4. **保密提醒**：检查单可能包含航班运行敏感信息
