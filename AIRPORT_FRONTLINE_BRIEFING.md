# AERO Agent 给一线运行人员的功能与流程讲解稿

本文用于给机场一线运行/机坪/指挥人员做项目介绍，重点讲两条主流程：
1) 快速工单（30 秒内“落单+留痕”）
2) 特情 Agent（多轮对话式处置与闭环）

---

## 0. 这个系统解决什么问题（一句话）
把“机坪特情的口头汇报 + 人工判断 + 人工填表/通知”变成：**信息自动抽取 → 风险等级确定性评估 → 影响范围（地图）自动推演 → 必要通知与处置建议 → 自动生成检查单/工单并可导出归档**。

系统面向典型机坪场景：
- 漏油/油污（oil_spill）
- 鸟击（bird_strike）
- FOD 外来物（fod）

输出的核心“工单/检查单”是可直接用于运行留痕与复盘的 Markdown 报告（可导出 PDF/Markdown）。

---

## 1) 快速工单：实现流程（给一线人员怎么讲）

### 1.1 适用场景
当现场需要“**先把事情快速落到工单里**”，并希望系统自动补齐关键信息、给出风险与影响建议时，用“快速工单”模式最合适：
- 值班席位接到简短汇报，需要快速形成记录
- 不想走完整对话流程，但又不想漏填关键字段
- 需要把影响范围在地图上快速标出来，给指挥/协同单位看

### 1.2 一线使用步骤（界面操作口径）
1. 点击页面右上角：`快速工单`
2. 选择场景：漏油 / 鸟击 / FOD
3. 两种填法（二选一）：
   - **粘贴/输入完整描述**（比如通话转文字、微信群汇报），点 `自动提取字段`
   - 或者 **直接填必填项**（航班号、位置、关键参数等）
4. 点击 `生成工单`
5. 系统会给出：
   - 工单概览（先看要点）
   - 可展开查看完整工单（检查单）
   - 地图侧同步高亮受影响区域（机位/滑行道/跑道）与扩散动画（如有）
6. 导出归档：右上角 `导出报告` → PDF / Markdown

### 1.3 系统在后台做了什么（用“可理解”的表达）
快速工单不是“套模板写一段话”，而是跑了一条“缩短版处置链路”：
- **信息抽取**：从文本中提取航班号、位置、特情类型、关键参数（如油液类型/是否持续/发动机状态等）
- **自动补全**（能查到就自动补）：
  - 航班基础信息/航班计划（如果有数据源）
  - 位置拓扑（机位/滑行道/跑道的关联关系）
- **风险评估（确定性规则）**：
  - 漏油按规则矩阵给出 R1-R4 风险与原因
  - 鸟击按 BSRC 规则给出 R1-R4 风险与管控提示
- **影响范围推演（拓扑图 BFS 扩散）**：
  - 根据“位置 + 风险等级 + 介质类型”确定扩散半径
  - 输出受影响机位/滑行道/跑道，供地图高亮
- **生成工单/检查单**：自动把以上信息组织成标准章节，便于留痕与审计

你可以把它对外讲成一句话：
“快速工单 = 把现场一句话描述，自动变成一张‘可执行、可追踪、可复盘’的处置检查单。”

---

## 2) 特情 Agent：实现流程（给一线人员怎么讲）

### 2.1 适用场景
当你希望系统像“值班助理”一样，**按真实处置逻辑一步步追问、判断、提醒、闭环**时，用特情 Agent 模式：
- 真实通话处置：信息不完整，需要追问
- 高风险事件：必须保证流程合规、通知不漏项
- 希望看到“当前处置到哪一步、下一步该做什么”

### 2.2 对话角色口径（现场最容易理解）
- Agent 角色：机坪管制员 / 运行席位（主动问）
- 用户角色：机组/现场报告人（回答信息）

典型开场：
- “XX机坪，请讲。”
- 报告人描述特情后，系统会按场景追问关键字段（位置、状态、持续性、影响等）。

### 2.3 Agent 内部的“核心闭环链路”（按真实处置节奏讲）
可以用 8 步话术来讲清楚：
1. **接报与归一化**：把通话/文本里的航班号、位置、关键事实抽出来，统一成结构化字段
2. **P1 关键信息收集**：系统知道哪些字段必须问到（不同场景不同字段顺序），没齐就继续追问
3. **风险评估**：P1 信息齐了，自动跑规则引擎得到 R1-R4 风险等级与原因
4. **影响范围分析（地图）**：结合机场真实拓扑图推演隔离范围，给出受影响机位/滑行道/跑道
5. **强制动作触发**：如果满足条件（例如高风险），系统会提示/触发必须动作（如通知消防、塔台等）
6. **协同与运行影响**：记录通知对象与时序，必要时给出航班影响提示（如跑道/滑行道受影响）
7. **报告生成**：生成标准检查单/工单（可导出）
8. **补充信息确认与关闭**：系统会问“是否有补充”，确认后闭环归档

### 2.4 为什么它“既灵活又不乱”（项目特色要点）
这套 Agent 不是纯大模型“自由发挥”，而是三层融合：
- **LLM 负责灵活对话与决策**：决定下一步问什么/调什么工具
- **确定性工具负责计算**：风险评估、空间影响推演等必须可复现、可审计
- **FSM 状态机做流程校验**：关键步骤做没做、强制动作漏没漏，会提示补救

对一线人员的价值就是：
“系统可以跟着现场节奏走，但关键动作不会漏，处置过程可追溯。”

---

## 3) 两条流程的对比（现场讲解用）

| 维度 | 快速工单 | 特情 Agent |
|---|---|---|
| 目标 | 快速落单、先留痕 | 对话式处置、强合规闭环 |
| 输入方式 | 表单/粘贴文本 | 多轮对话（追问补齐） |
| 适用 | 信息基本齐全、需要快速出单 | 信息不全、高风险、需严格流程 |
| 输出 | 工单概览 + 完整检查单 + 地图高亮 | 实时对话 + 检查单 + FSM 进度 + 地图高亮 |

---

## 4) 给现场的“展示点”建议（可按 5 分钟节奏讲）
1. 用“快速工单”演示：粘贴一段特情描述 → 一键生成工单 + 地图高亮
2. 用“特情 Agent”演示：让系统追问 2~3 个关键字段 → 自动给出风险等级与下一步动作
3. 展示导出：PDF/Markdown 一键归档（便于复盘与审计）

---

## 5) 实现映射（给技术/信息化同事的“落点”）
如果现场有人问“这是不是大模型瞎写”，可以用下面这些“真实落点”回应：
- 工单/检查单模板：`agent/templates/`
- Agent 主流程编排（LangGraph）：`agent/graph.py`
- 风险评估（确定性规则）：`tools/assessment/`
- 空间影响推演（拓扑 + BFS）：`tools/spatial/`
- FSM 校验与强制动作：`fsm/engine.py`、`fsm/validator.py`
- API 服务（前端/大屏对接）：`apps/api/main.py`
- 前端入口：
  - 快速工单抽屉：`frontend/src/components/quick/QuickReportDrawer.tsx`
  - 地图高亮：`frontend/src/components/visualization/TopologyMap.tsx`

