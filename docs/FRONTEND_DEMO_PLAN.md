# 前端交互演示页面方案（油污泄漏场景）

## 目标与范围
- 面向领导演示“智能、可解释、合规、可落地”的特情处置能力
- 以油污泄漏为主要场景，支持自由输入（非固定脚本）
- 页面可交互，体验与现有终端 Agent 流程一致
- 中文为主，可扩展英文版本

## 核心卖点
- 一句话输入，自动补全关键信息（航班、机位、天气、拓扑）
- 推理链路可解释（工具调用、规则触发、证据链）
- FSM 合规可视化，流程清晰可追溯
- 风险评估与处置建议同步生成
- 影响预测可视化（区域与航班）

## 页面结构（单页交互）
1. 顶部摘要区
   - 事件类型、风险等级、FSM 阶段、处置状态
   - 一句话智能结论与关键建议
2. 左侧交互区
   - 对话时间线（用户/系统）
   - 工具调用轨迹（航班查询、天气、拓扑、风险评估）
   - 推理摘要（可折叠）
3. 中部能力可视化
   - FSM 状态机图（当前状态高亮、已走路径）
   - 机坪拓扑影响图/扩散区域
   - 风险评估卡片（规则引擎 + LLM 交叉验证一致性）
4. 右侧处置区
   - 通知清单（消防、塔台、运行等）
   - 处置建议清单（P1/P2/P3 分级）
   - 报告摘要（可展开全文）
5. 底部可信度与数据源
   - 数据来源：历史数据 / 实时数据
   - 一致性与置信度指标
   - 关键字段展示（航班、天气、位置、时间）

## 交互流程（与终端一致）
1. 用户输入：自然语言描述油污泄漏
2. 系统自动补全：航班、机位、天气、拓扑信息
3. 推理链路与工具调用：逐步推进 FSM 状态
4. 输出结果：风险等级 + 处置建议 + 影响预测
5. 生成报告：摘要 + 可展开全文

## 数据模式与切换
- 演示模式（默认）
  - 使用本地历史数据
  - 稳定可控，适合领导展示
- 在线模式（可选）
  - 接真实航班/天气数据
  - 增强真实感，但依赖外部数据稳定性
- 模式切换
  - 页面右上角开关 + 状态提示条
  - 提示当前使用的数据源

## API 接入建议（可选）
- 复用现有接口：
  - POST /event/start
  - POST /event/chat
  - GET /event/{session_id}
  - GET /event/{session_id}/report
- 接口异常时自动回退演示模式，保证演示不中断

## 可视化技术选型（推荐）
- 组合方案：ECharts 为主，D3.js 作为局部定制补充
- 选择理由：
  - ECharts 覆盖常规图表与大屏展示，开发效率高、稳定性好
  - D3.js 适合高定制交互（FSM 状态机、拓扑扩散路径高亮）

### 图表与技术映射建议
- ECharts：
  - 顶部摘要区的状态卡与指标趋势图
  - 风险评估的分级/雷达/条形对比
  - 影响航班数量的时间序列与分布统计
- D3.js：
  - FSM 状态机图（状态路径高亮、节点联动）
  - 机坪拓扑扩散图（力导向布局、区域扩散动画）

## 提示说明（合规与风险提示）
- 本页面为辅助决策系统，最终处置由指挥员确认
- 在线模式依赖外部数据源，结果受数据质量影响
- 系统已通过 FSM 合规校验与风险交叉验证

## 展示文案示例
- “一句话输入，系统自动补全关键信息”
- “智能推理 + 规则校验，确保合规闭环”
- “风险评估与处置建议同时生成”
- “影响区域与航班预测实时呈现”

## 风险与降级策略
- 外部数据不可用时，自动切换历史数据
- LLM 失败时，显示“规则引擎已接管”提示
- 关键可视化失败时，保留对话与报告输出，避免空白

## 下一步可选输出
- 页面文案与字段清单（每个模块需要哪些数据）
- 1-2 分钟演示话术稿
- 低保真交互结构稿
