Metadata-Version: 2.4
Name: airport-emergency-agent
Version: 1.0.0
Summary: èåˆ ReAct Agent + FSM éªŒè¯çš„æœºåœºæœºåªåº”æ€¥å“åº”æ™ºèƒ½ç³»ç»Ÿ
Author: Airport Digital Twin Team
License: MIT
Keywords: airport,emergency,agent,langgraph,fsm
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: langgraph>=0.2.0
Requires-Dist: langchain>=0.2.0
Requires-Dist: langchain-core>=0.2.0
Requires-Dist: jinja2>=3.1.0
Requires-Dist: fastapi>=0.110.0
Requires-Dist: uvicorn>=0.27.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: pydantic-settings>=2.0.0
Requires-Dist: shapely>=2.0.0
Requires-Dist: pyyaml>=6.0.0
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: httpx>=0.27.0
Provides-Extra: dev
Requires-Dist: pytest>=8.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.23.0; extra == "dev"
Requires-Dist: black>=24.0.0; extra == "dev"
Requires-Dist: isort>=5.13.0; extra == "dev"
Requires-Dist: mypy>=1.8.0; extra == "dev"
Provides-Extra: llm
Requires-Dist: openai>=1.0.0; extra == "llm"
Requires-Dist: zhipuai>=2.0.0; extra == "llm"
Requires-Dist: langchain-openai>=0.1.0; extra == "llm"
Provides-Extra: vector
Requires-Dist: sentence-transformers>=2.2.0; extra == "vector"

# æœºåœºæœºåªåº”æ€¥å“åº”æ™ºèƒ½ Agent ç³»ç»Ÿ

## é¡¹ç›®æ¦‚è¿°

æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªèåˆ **ReAct Agent** ä¸ **FSM çŠ¶æ€æœºéªŒè¯** çš„æ™ºèƒ½åº”æ€¥å“åº”ç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºå¤„ç†æœºåœºæœºåªæ¼æ²¹ç­‰ç‰¹æƒ…äº‹ä»¶ã€‚

### å¯¹è¯æ¨¡å¼ ğŸ¯

**Agent è§’è‰²**ï¼šæœºåªç®¡åˆ¶å‘˜ï¼ˆApron Controllerï¼‰
**ç”¨æˆ·è§’è‰²**ï¼šèˆªç©ºå™¨æœºé•¿ï¼ˆCaptain/PICï¼‰

ç³»ç»Ÿé‡‡ç”¨ **ä¸»åŠ¨è¯¢é—®æ¨¡å¼**ï¼Œæœºåªç®¡åˆ¶Agentå‘æœºé•¿æ”¶é›†ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„å¯¹è¯ç¤ºä¾‹ï¼š

#### å®Œæ•´å¯¹è¯ç¤ºä¾‹

```
æœºåªç®¡åˆ¶: å¤©åºœæœºåªï¼Œè¯·è®²ã€‚

æœºé•¿: å¤©åºœæœºåªï¼Œå·èˆª3349æŠ¥å‘Šç´§æ€¥æƒ…å†µï¼Œå³ä¾§å‘åŠ¨æœºæœ‰æ»‘æ²¹æ³„æ¼ï¼Œå¯è§æŒç»­æ»´æ¼ï¼Œæ³„æ¼é¢ç§¯ä¸æ˜ï¼Œè¯·æ±‚æ”¯æ´ã€‚

æœºåªç®¡åˆ¶: å·èˆª3349ï¼Œå…·ä½“ä½ç½®ï¼ˆåœæœºä½å·/æ»‘è¡Œé“/è·‘é“ï¼‰ï¼Ÿå‘åŠ¨æœºå½“å‰çŠ¶æ€ï¼Ÿè¿è½¬ä¸­è¿˜æ˜¯å·²å…³é—­ï¼Ÿ

æœºé•¿: å¤©åºœæœºåª æˆ‘åœ¨æ»‘è¡Œé“10 å‘åŠ¨æœºå·²å…³æœº

æœºåªç®¡åˆ¶: å·èˆª3349ï¼Œå¤„ç½®æµç¨‹å·²å®Œæˆã€‚ä½ è¿˜æœ‰ä»€ä¹ˆéœ€è¦è¡¥å……çš„å—ï¼Ÿ

æœºé•¿: å¤©åºœæœºåª æ— è¡¥å……ä¿¡æ¯ å®Œæ¯•
```

#### äº¤äº’æµç¨‹è§£æ

1. **åˆå§‹å‘¼å«**
   - æœºåªç®¡åˆ¶ä¸»åŠ¨å‘¼å«ï¼Œç­‰å¾…æœºé•¿æŠ¥å‘Š
   - æ ‡å‡†åŒ–å¼€åœºç™½å»ºç«‹ä¸“ä¸šæ²Ÿé€šæ°›å›´

2. **ç´§æ€¥æƒ…å†µæŠ¥å‘Š**
   - æœºé•¿æŠ¥å‘Šï¼šèˆªç­å·ã€ä½ç½®ã€æ³„æ¼ç±»å‹ã€æŒç»­çŠ¶æ€
   - Agent è‡ªåŠ¨æå–ï¼šèˆªç­å·ã€æ¶²ä½“ç±»å‹ï¼ˆæ»‘æ²¹ï¼‰ã€æŒç»­æ»´æ¼
   - è§¦å‘è‡ªåŠ¨æŸ¥è¯¢ï¼šèˆªç­è®¡åˆ’ä¿¡æ¯ã€ä½ç½®æ‹“æ‰‘åˆ†æ

3. **ä¿¡æ¯æ”¶é›†ï¼ˆæ™ºèƒ½å¼•å¯¼ï¼‰**
   - Agent ä¸»åŠ¨è¯¢é—®å…³é”®ä¿¡æ¯ï¼šä½ç½®è¯¦æƒ…ã€å‘åŠ¨æœºçŠ¶æ€
   - ç¬¦åˆå®é™…åœºæ™¯ï¼šæœºåªç®¡åˆ¶é€šå¸¸éœ€è¦ç²¾ç¡®ä½ç½®å’Œè®¾å¤‡çŠ¶æ€
   - é€æ­¥æ”¶é›†ï¼šfluid_type â†’ position â†’ engine_status â†’ continuous

4. **è‡ªåŠ¨åˆ†æä¸å“åº”**
   - ä½ç½®ç¡®è®¤ï¼šæ»‘è¡Œé“10 â†’ æ‹“æ‰‘åˆ†æ â†’ å½±å“èŒƒå›´è®¡ç®—
   - å‘åŠ¨æœºçŠ¶æ€ï¼šå·²å…³æœº â†’ é£é™©ç­‰çº§è°ƒæ•´
   - è‡ªåŠ¨è§¦å‘ï¼šé£é™©è¯„ä¼°ã€ç©ºé—´åˆ†æã€éƒ¨é—¨é€šçŸ¥

5. **æµç¨‹å®Œæˆç¡®è®¤**
   - å¤„ç½®å®Œæˆåè¯¢é—®è¡¥å……ä¿¡æ¯
   - æ ‡å‡†åŒ–ç»“æŸè¯­

**ç‰¹ç‚¹**ï¼š
- âœ… ä¸“ä¸šç®€æ´çš„å¯¹è¯é£æ ¼ï¼ˆ"æœºé•¿ï¼ŒæŠ¥å‘Šä½ æœºå·" vs "è¯·æä¾›èˆªç­å·"ï¼‰
- âœ… ä¸»åŠ¨å¼•å¯¼ä¿¡æ¯æ”¶é›†æµç¨‹
- âœ… ç¬¦åˆå®é™…æœºåœºè¿è¡Œåœºæ™¯
- âœ… å°Šé‡æœºé•¿æƒå¨ï¼ˆå¯ç§°å‘¼"æœºé•¿"ï¼‰
- âœ… è‡ªåŠ¨è§¦å‘åˆ†æï¼ˆèˆªç­æŸ¥è¯¢ã€ç©ºé—´æ¨ç†ã€é£é™©è¯„ä¼°ï¼‰
- âœ… å®æ—¶åé¦ˆåˆ†æç»“æœç»™ç®¡åˆ¶å‘˜

#### è¿è¡Œæ–¹å¼

```bash
# æ–¹å¼ä¸€ï¼šç®€å•æ¨¡æ‹Ÿæµ‹è¯•ï¼ˆæ— éœ€APIå¯†é’¥ï¼‰
python test_dialogue_example.py --mock

# æ–¹å¼äºŒï¼šå®Œæ•´è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆæ¨èï¼‰
python test_automated_dialogue.py

# æ–¹å¼ä¸‰ï¼šäº¤äº’å¼ç»ˆç«¯ï¼ˆéœ€è¦ LLM API å¯†é’¥ï¼‰
python apps/run_agent.py

# æ–¹å¼å››ï¼šçœŸå®LLMæµ‹è¯•
python test_dialogue_example.py --llm
```

æµ‹è¯•è¯´æ˜ï¼š
- **ç®€å•æ¨¡æ‹Ÿæµ‹è¯•**: å±•ç¤ºå¯¹è¯ç¤ºä¾‹å’Œç³»ç»Ÿå¤„ç†ç»“æœ
- **å®Œæ•´è‡ªåŠ¨åŒ–æµ‹è¯•**: è¯¦ç»†å±•ç¤º7æ­¥å¤„ç†æµç¨‹ï¼ˆä¿¡æ¯æ”¶é›†â†’é£é™©è¯„ä¼°â†’ç©ºé—´åˆ†æâ†’éƒ¨é—¨é€šçŸ¥â†’æŠ¥å‘Šç”Ÿæˆï¼‰
- **äº¤äº’å¼ç»ˆç«¯**: çœŸå®LLMé©±åŠ¨çš„å¤šè½®å¯¹è¯
- **çœŸå®LLMæµ‹è¯•**: ç»“åˆæ¨¡æ‹Ÿå’ŒçœŸå®LLMçš„æ··åˆæ¨¡å¼

æ¨¡æ‹Ÿæµ‹è¯•ä¼šå±•ç¤ºå®Œæ•´çš„å¯¹è¯æµç¨‹å’Œç³»ç»Ÿå¤„ç†ç»“æœï¼ŒåŒ…æ‹¬ï¼š
- ä¿¡æ¯è‡ªåŠ¨æå–ï¼ˆèˆªç­å·ã€æ¶²ä½“ç±»å‹ã€ä½ç½®ã€å‘åŠ¨æœºçŠ¶æ€ï¼‰
- é£é™©è¯„ä¼°åˆ†æï¼ˆMEDIUMçº§é£é™©ï¼Œ45/100åˆ†ï¼‰
- ç©ºé—´å½±å“åˆ†æï¼ˆæ»‘è¡Œé“10åŠå‘¨è¾¹åŒºåŸŸï¼‰
- æŠ¥å‘Šç”Ÿæˆï¼ˆ11ä¸ªæ ‡å‡†ç« èŠ‚ï¼‰

è¯¦è§ï¼š[DIALOGUE_ROLE_CHANGE.md](./DIALOGUE_ROLE_CHANGE.md)

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    èåˆæ¶æ„ï¼šReAct ä¸»å¯¼ + FSM éªŒè¯               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              ReAct Agent (ä¸»å¯¼å±‚)                        â”‚    â”‚
â”‚  â”‚   - LLM å†³å®šæ¨ç†è·¯å¾„å’Œå·¥å…·è°ƒç”¨é¡ºåº                        â”‚    â”‚
â”‚  â”‚   - çµæ´»åº”å¯¹å¤æ‚åœºæ™¯å’Œæ„å¤–æƒ…å†µ                            â”‚    â”‚
â”‚  â”‚   - å— Checklist å’Œçº¦æŸç³»ç»Ÿçº¦æŸ                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              FSM éªŒè¯å±‚ (éé©±åŠ¨å±‚)                        â”‚    â”‚
â”‚  â”‚   - éªŒè¯ Agent æ˜¯å¦å®Œæˆå¿…è¦æ­¥éª¤                          â”‚    â”‚
â”‚  â”‚   - ç¡®ä¿çŠ¶æ€è½¬æ¢ç¬¦åˆè§„èŒƒæµç¨‹                              â”‚    â”‚
â”‚  â”‚   - æ£€æŸ¥å¼ºåˆ¶åŠ¨ä½œæ˜¯å¦æ‰§è¡Œ                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              ç¡®å®šæ€§è®¡ç®—å±‚ (å·¥å…·)                          â”‚    â”‚
â”‚  â”‚   - é£é™©è¯„ä¼°ï¼šè§„åˆ™å¼•æ“ï¼ˆç¡®å®šæ€§ï¼‰                          â”‚    â”‚
â”‚  â”‚   - ç©ºé—´æ¨ç†ï¼šGraph ç®—æ³•ï¼ˆç¡®å®šæ€§ï¼‰                        â”‚    â”‚
â”‚  â”‚   - LLM ä¸ç›´æ¥è®¡ç®—ï¼Œè€Œæ˜¯è°ƒç”¨å·¥å…·                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### èåˆä¼˜åŠ¿

| æ¥æº | ç‰¹æ€§ |
|------|------|
| ReAct Agent | çµæ´»æ¨ç†ã€å³æ—¶å“åº”ã€å¤„ç†æ„å¤– |
| FSM éªŒè¯ | å¯å®¡è®¡ã€æµç¨‹åˆè§„ã€çŠ¶æ€è¿½è¸ª |
| è§„åˆ™å¼•æ“ | ç¡®å®šæ€§é£é™©è¯„ä¼° |
| Graph ç®—æ³• | ç¡®å®šæ€§ç©ºé—´æ¨ç† |

## ç›®å½•ç»“æ„

```
airport-emergency-agent/
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ settings.py           # å…¨å±€é…ç½®
â”‚   â””â”€â”€ llm_config.py         # LLM é…ç½®
â”œâ”€â”€ scenarios/                 # åœºæ™¯é…ç½®
â”‚   â”œâ”€â”€ base.py               # åœºæ™¯åŸºç±»ä¸æ³¨å†Œä¸­å¿ƒ
â”‚   â”œâ”€â”€ SCENARIO_GUIDE.md     # åœºæ™¯å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ oil_spill/            # æ¼æ²¹åœºæ™¯ (âœ… å·²å®ç°)
â”‚   â”‚   â”œâ”€â”€ config.yaml       # åœºæ™¯é…ç½®
â”‚   â”‚   â”œâ”€â”€ checklist.yaml    # Checklist å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ fsm_states.yaml   # FSM çŠ¶æ€å®šä¹‰
â”‚   â”‚   â””â”€â”€ prompt.yaml       # âœ… åœºæ™¯ä¸“å± System Prompt
â”‚   â””â”€â”€ bird_strike/          # é¸Ÿå‡»åœºæ™¯ (âœ… ç¤ºä¾‹å®Œæˆ)
â”‚       â””â”€â”€ prompt.yaml       # âœ… åœºæ™¯ä¸“å± System Prompt
â”œâ”€â”€ agent/                     # Agent æ ¸å¿ƒ
â”‚   â”œâ”€â”€ state.py              # çŠ¶æ€å®šä¹‰
â”‚   â”œâ”€â”€ graph.py              # LangGraph å›¾å®šä¹‰
â”‚   â”œâ”€â”€ nodes/                # èŠ‚ç‚¹å®ç°
â”‚   â”‚   â”œâ”€â”€ input_parser.py   # âœ… è¾“å…¥è§£æ
â”‚   â”‚   â”œâ”€â”€ reasoning.py      # âœ… ReAct æ¨ç†
â”‚   â”‚   â”œâ”€â”€ tool_executor.py  # âœ… å·¥å…·æ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ fsm_validator.py  # âœ… FSM éªŒè¯
â”‚   â”‚   â””â”€â”€ output_generator.py # âœ… æŠ¥å‘Šç”Ÿæˆ
â”‚   â””â”€â”€ prompts/              # Prompt æ¨¡æ¿
â”œâ”€â”€ tools/                     # å·¥å…·å®ç°
â”‚   â”œâ”€â”€ base.py               # å·¥å…·åŸºç±»
â”‚   â”œâ”€â”€ registry.py           # å·¥å…·æ³¨å†Œä¸­å¿ƒ
â”‚   â”œâ”€â”€ information/          # ä¿¡æ¯æ”¶é›†ç±»
â”‚   â”‚   â”œâ”€â”€ ask_for_detail.py     # âœ… è¿½é—®è¯¦æƒ…
â”‚   â”‚   â””â”€â”€ get_aircraft_info.py  # âœ… è·å–é£æœºä¿¡æ¯
â”‚   â”œâ”€â”€ spatial/              # ç©ºé—´æ¨ç†ç±»
â”‚   â”‚   â”œâ”€â”€ get_stand_location.py # âœ… æœºä½æŸ¥è¯¢
â”‚   â”‚   â””â”€â”€ calculate_impact_zone.py # âœ… å½±å“åŒºåŸŸè®¡ç®—
â”‚   â”œâ”€â”€ knowledge/            # çŸ¥è¯†æ£€ç´¢ç±»
â”‚   â”‚   â””â”€â”€ search_regulations.py # âœ… è§„ç« æ£€ç´¢
â”‚   â”œâ”€â”€ assessment/           # è¯„ä¼°ç±»
â”‚   â”‚   â””â”€â”€ assess_risk.py    # âœ… é£é™©è¯„ä¼°
â”‚   â””â”€â”€ action/               # è¡ŒåŠ¨ç±»
â”‚       â”œâ”€â”€ notify_department.py  # âœ… é€šçŸ¥éƒ¨é—¨
â”‚       â””â”€â”€ generate_report.py    # âœ… ç”ŸæˆæŠ¥å‘Š
â”œâ”€â”€ fsm/                       # FSM éªŒè¯å±‚
â”‚   â”œâ”€â”€ engine.py             # FSM å¼•æ“
â”‚   â”œâ”€â”€ validator.py          # çŠ¶æ€éªŒè¯å™¨
â”‚   â””â”€â”€ states.py             # çŠ¶æ€å®šä¹‰
â”œâ”€â”€ constraints/               # çº¦æŸç³»ç»Ÿ
â”‚   â”œâ”€â”€ loader.py             # âœ… çº¦æŸåŠ è½½å™¨
â”‚   â””â”€â”€ checker.py            # âœ… çº¦æŸæ£€æŸ¥å™¨
â”œâ”€â”€ spatial/                   # ç©ºé—´æ¨ç† (âš ï¸ éƒ¨åˆ†å®ç°)
â”‚   â””â”€â”€ data/                 # æœºåœºæ‹“æ‰‘æ•°æ®
â”‚       â””â”€â”€ airport_topology.json  # âœ… æ‹“æ‰‘æ•°æ®
â”œâ”€â”€ api/                       # API æ¥å£
â”‚   â””â”€â”€ main.py               # FastAPI å…¥å£
â”œâ”€â”€ tests/                     # æµ‹è¯•
â”‚   â””â”€â”€ test_integration.py   # âœ… é›†æˆæµ‹è¯•
â”œâ”€â”€ run_demo.py               # âœ… Demo è„šæœ¬ï¼ˆæ— éœ€ LLMï¼‰
â”œâ”€â”€ run_interactive.py        # âœ… äº¤äº’æ¨¡å¼ï¼ˆéœ€ LLMï¼‰
â””â”€â”€ pyproject.toml            # âœ… Poetry é…ç½®
```

> **çŠ¶æ€æ ‡è®°**: âœ… å·²å®ç° | âš ï¸ éƒ¨åˆ†å®ç° | âŒ ç¼ºå¤±

## ç¼ºå¤±ç»„ä»¶åŠä¼˜å…ˆçº§è¯„ä¼°

### é«˜ä¼˜å…ˆçº§ (å½±å“æ ¸å¿ƒåŠŸèƒ½) âœ… å·²å®Œæˆ

| ç»„ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| `constraints/loader.py` | âœ… å·²å®Œæˆ | ä» YAML é…ç½®åŠ è½½çº¦æŸå®šä¹‰ |
| `constraints/checker.py` | âœ… å·²å®Œæˆ | Checklist çº¦æŸæ£€æŸ¥ä¸å¼ºåˆ¶åŠ¨ä½œéªŒè¯ |

### ä¸­ä¼˜å…ˆçº§ (å½±å“ç³»ç»Ÿå®Œæ•´æ€§)

| ç»„ä»¶ | çŠ¶æ€ | å½±å“ | é¢„ä¼°å·¥ä½œé‡ |
|------|------|------|-----------|
| `rules/risk_engine.py` | âš ï¸ éƒ¨åˆ†å®ç° | é£é™©è¯„ä¼°è§„åˆ™ä¸å¤Ÿå®Œå–„ï¼Œå¯èƒ½å½±å“é«˜é£é™©åœºæ™¯åˆ¤æ–­å‡†ç¡®æ€§ | 3-4 å¤© |
| `spatial/topology.py` | âŒ ç¼ºå¤± | ç¼ºå°‘æœºåœºæ‹“æ‰‘ç»“æ„å®šä¹‰ï¼Œå½±å“å¤æ‚åœºæ™¯åˆ†æ | 2-3 å¤© |
| `spatial/graph_engine.py` | âŒ ç¼ºå¤± | ç¼ºå°‘è·¯å¾„æŸ¥æ‰¾ç®—æ³•ï¼Œå½±å“å½±å“åŒºåŸŸè®¡ç®— | 2-3 å¤© |

### ä½ä¼˜å…ˆçº§ (æ‰©å±•åŠŸèƒ½)

| ç»„ä»¶ | çŠ¶æ€ | è¯´æ˜ | é¢„ä¼°å·¥ä½œé‡ |
|------|------|------|-----------|
| `knowledge/retriever.py` | âš ï¸ ä½¿ç”¨ä¸­ | å½“å‰ `search_regulations.py` å·²å®ç°åŸºæœ¬åŠŸèƒ½ | - |
| `scenarios/bird_strike/` | âŒ ç¼ºå¤± | é¸Ÿå‡»åœºæ™¯æ‰©å±•ï¼Œå¢åŠ æ–°åœºæ™¯éœ€ 1-2 å‘¨ | 1-2 å‘¨ |
| `scenarios/tire_burst/` | âŒ ç¼ºå¤± | è½®èƒçˆ†ç ´åœºæ™¯ | 1-2 å‘¨ |
| `scenarios/runway_incursion/` | âŒ ç¼ºå¤± | è·‘é“å…¥ä¾µåœºæ™¯ | 2-3 å‘¨ |

### å®ç°å»ºè®®

**é˜¶æ®µä¸€ (æ ¸å¿ƒä¿®å¤)** - âœ… å·²å®Œæˆ
1. å®ç° `constraints/` å®Œæ•´çº¦æŸç³»ç»Ÿ - ç¡®ä¿æµç¨‹åˆè§„ âœ…

**é˜¶æ®µäºŒ (èƒ½åŠ›å¢å¼º)**ï¼š
1. å®Œå–„ `rules/risk_engine.py` - å¢å¼ºé£é™©è¯„ä¼°å‡†ç¡®æ€§
2. å®ç° `spatial/topology.py` - æœºåœºæ‹“æ‰‘å»ºæ¨¡
3. å®ç° `spatial/graph_engine.py` - è·¯å¾„æŸ¥æ‰¾ä¸å½±å“åˆ†æ

**é˜¶æ®µä¸‰ (åœºæ™¯æ‰©å±•)**ï¼š
1. æ·»åŠ æ›´å¤šåº”æ€¥åœºæ™¯æ”¯æŒ

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10+
- LangGraph
- FastAPI
- Shapely (ç©ºé—´æ¨ç†)

### å®‰è£…

```bash
# ä½¿ç”¨ Poetry å®‰è£…ï¼ˆæ¨èï¼‰
pip install poetry
poetry install

# æˆ–ä½¿ç”¨ pip
pip install -e ".[dev,llm]"
```

### è¿è¡Œ

```bash
# å¯åŠ¨ API æœåŠ¡
python -m apps.api.main

# è¿è¡Œ Demo è„šæœ¬ï¼ˆæ— éœ€ LLMï¼‰
python run_demo.py

# äº¤äº’æ¨¡å¼ï¼ˆéœ€é…ç½® LLM_API_KEYï¼‰
python run_interactive.py

# è¿è¡Œæµ‹è¯•
python -m pytest tests/
```

### ç¯å¢ƒé…ç½®

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®ï¼ˆæ”¯æŒ zhipu å’Œ openai æä¾›å•†ï¼‰
# LLM_PROVIDER=zhipu
# LLM_MODEL=glm-4
# LLM_API_KEY=your_api_key
```

## æ ¸å¿ƒæµç¨‹

```
ç”¨æˆ·è¾“å…¥ â†’ è¾“å…¥è§£æ â†’ ReAct æ¨ç†å¾ªç¯ â†’ FSM éªŒè¯ â†’ è¾“å‡ºæŠ¥å‘Š
                          â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å·¥å…·è°ƒç”¨    â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ - è¿½é—®ä¿¡æ¯   â”‚
                    â”‚ - é£é™©è¯„ä¼°   â”‚
                    â”‚ - ç©ºé—´åˆ†æ   â”‚
                    â”‚ - é€šçŸ¥éƒ¨é—¨   â”‚
                    â”‚ - ç”ŸæˆæŠ¥å‘Š   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ”¯æŒçš„åœºæ™¯

### åœºæ™¯ Prompt ç³»ç»Ÿ

æ¯ä¸ªåœºæ™¯æ‹¥æœ‰ç‹¬ç«‹çš„ `prompt.yaml` é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰ï¼š
- `system_prompt`: åœºæ™¯ä¸“å± System Prompt
- `field_order`: ä¿¡æ¯æ”¶é›†é¡ºåºï¼ˆå¼ºåˆ¶æŒ‰åºè¯¢é—®ï¼‰
- `field_names`: å­—æ®µä¸­æ–‡åç§°æ˜ å°„
- `ask_prompts`: å„å­—æ®µçš„è¿½é—®æç¤º

```
scenarios/
â”œâ”€â”€ oil_spill/prompt.yaml      # æ¼æ²¹åœºæ™¯ Prompt
â”‚   field_order:
â”‚     - flight_no     # 1. èˆªç­å·
â”‚     - position      # 2. äº‹å‘ä½ç½®
â”‚     - fluid_type    # 3. æ²¹æ¶²ç±»å‹
â”‚     - engine_status # 4. å‘åŠ¨æœºçŠ¶æ€
â”‚     - continuous    # 5. æ˜¯å¦æŒç»­æ»´æ¼
â”‚     - leak_size     # 6. æ³„æ¼é¢ç§¯
â”‚
â””â”€â”€ bird_strike/prompt.yaml    # é¸Ÿå‡»åœºæ™¯ Promptï¼ˆç¤ºä¾‹ï¼‰
    field_order:
      - flight_no     # 1. èˆªç­å·
      - position      # 2. äº‹å‘ä½ç½®
      - strike_area   # 3. æ’å‡»éƒ¨ä½
      - engine_status # 4. å‘åŠ¨æœºçŠ¶æ€
      - flight_phase  # 5. é£è¡Œé˜¶æ®µ
```

### åœºæ™¯åˆ—è¡¨

| åœºæ™¯ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| oil_spill | âœ… å·²å®ç° | æ²¹æ¶²æ³„æ¼å¤„ç† |
| bird_strike | âœ… ç¤ºä¾‹ | é¸Ÿå‡»äº‹ä»¶ï¼ˆå¯æ‰©å±•ï¼‰ |
| tire_burst | â³ è§„åˆ’ä¸­ | è½®èƒçˆ†ç ´åœºæ™¯ |
| runway_incursion | â³ è§„åˆ’ä¸­ | è·‘é“å…¥ä¾µåœºæ™¯ |

### æ·»åŠ æ–°åœºæ™¯

1. åˆ›å»º `scenarios/<åœºæ™¯å>/` ç›®å½•
2. æ·»åŠ  `prompt.yaml`ï¼ˆå¿…éœ€ï¼‰
3. å¯é€‰ï¼šæ·»åŠ  `config.yaml`, `checklist.yaml`, `fsm_states.yaml`
4. åœ¨ `scenarios/base.py` ä¸­æ³¨å†Œæ–°åœºæ™¯ç±»

è¯¦ç»†æŒ‡å—è§ [SCENARIO_GUIDE.md](scenarios/SCENARIO_GUIDE.md)

## License

MIT License
